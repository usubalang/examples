/* This code was generated by Usuba.
   See https://github.com/DadaIsCrazy/usuba.
   From the file "samples/usuba/present.ua" (included below). */

#include <stdint.h>

/* Do NOT change the order of those define/include */

#ifndef BITS_PER_REG
#define BITS_PER_REG 8
#endif
/* including the architecture specific .h */
#include "MASKED_UA.h"

/* auxiliary functions */
void sbox__B1 (/*inputs*/ DATATYPE X3__[MASKING_ORDER],DATATYPE X2__[MASKING_ORDER],DATATYPE X1__[MASKING_ORDER],DATATYPE X0__[MASKING_ORDER], /*outputs*/ DATATYPE Y3__[MASKING_ORDER],DATATYPE Y2__[MASKING_ORDER],DATATYPE Y1__[MASKING_ORDER],DATATYPE Y0__[MASKING_ORDER]) {

  // Variables declaration
  DATATYPE T1__[MASKING_ORDER];
  DATATYPE T2__[MASKING_ORDER];
  DATATYPE T3__[MASKING_ORDER];
  DATATYPE T4__[MASKING_ORDER];
  DATATYPE T5__[MASKING_ORDER];
  DATATYPE T6__[MASKING_ORDER];
  DATATYPE T7__[MASKING_ORDER];
  DATATYPE T8__[MASKING_ORDER];
  DATATYPE T9__[MASKING_ORDER];
  DATATYPE _tmp1_[MASKING_ORDER];

  // Instructions (body)
  for (int _mask_idx = 0; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
    T1__[_mask_idx] = XOR(X1__[_mask_idx],X2__[_mask_idx]);
  }
  _tmp1_[0] = NOT(X0__[0]);
  for (int _mask_idx = 1; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
    _tmp1_[_mask_idx] = X0__[_mask_idx];
  }
  MASKED_AND(T2__,X2__,T1__);
  for (int _mask_idx = 0; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
    T3__[_mask_idx] = XOR(X3__[_mask_idx],T2__[_mask_idx]);
    Y0__[_mask_idx] = XOR(X0__[_mask_idx],T3__[_mask_idx]);
  }
  MASKED_AND(T4__,T1__,T3__);
  for (int _mask_idx = 0; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
    T5__[_mask_idx] = XOR(T1__[_mask_idx],Y0__[_mask_idx]);
    T6__[_mask_idx] = XOR(T4__[_mask_idx],X2__[_mask_idx]);
  }
  MASKED_OR(T7__,X0__,T6__);
  for (int _mask_idx = 0; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
    T8__[_mask_idx] = XOR(T6__[_mask_idx],_tmp1_[_mask_idx]);
    Y1__[_mask_idx] = XOR(T5__[_mask_idx],T7__[_mask_idx]);
  }
  MASKED_OR(T9__,T8__,T5__);
  for (int _mask_idx = 0; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
    Y3__[_mask_idx] = XOR(Y1__[_mask_idx],T8__[_mask_idx]);
    Y2__[_mask_idx] = XOR(T3__[_mask_idx],T9__[_mask_idx]);
  }

}

void present_round__B1 (/*inputs*/ DATATYPE inp__[64][MASKING_ORDER],DATATYPE key__[64][MASKING_ORDER], /*outputs*/ DATATYPE out__[64][MASKING_ORDER]) {

  // Variables declaration
  DATATYPE sbox_in__[16][4][MASKING_ORDER];
  DATATYPE sbox_out__[16][4][MASKING_ORDER];

  // Instructions (body)
  for (int _mask_idx = 0; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
    sbox_in__[0][0][_mask_idx] = XOR(inp__[0][_mask_idx],key__[0][_mask_idx]);
    sbox_in__[1][0][_mask_idx] = XOR(inp__[4][_mask_idx],key__[4][_mask_idx]);
    sbox_in__[2][0][_mask_idx] = XOR(inp__[8][_mask_idx],key__[8][_mask_idx]);
    sbox_in__[3][0][_mask_idx] = XOR(inp__[12][_mask_idx],key__[12][_mask_idx]);
    sbox_in__[4][0][_mask_idx] = XOR(inp__[16][_mask_idx],key__[16][_mask_idx]);
    sbox_in__[5][0][_mask_idx] = XOR(inp__[20][_mask_idx],key__[20][_mask_idx]);
    sbox_in__[6][0][_mask_idx] = XOR(inp__[24][_mask_idx],key__[24][_mask_idx]);
    sbox_in__[7][0][_mask_idx] = XOR(inp__[28][_mask_idx],key__[28][_mask_idx]);
    sbox_in__[8][0][_mask_idx] = XOR(inp__[32][_mask_idx],key__[32][_mask_idx]);
    sbox_in__[9][0][_mask_idx] = XOR(inp__[36][_mask_idx],key__[36][_mask_idx]);
    sbox_in__[10][0][_mask_idx] = XOR(inp__[40][_mask_idx],key__[40][_mask_idx]);
    sbox_in__[11][0][_mask_idx] = XOR(inp__[44][_mask_idx],key__[44][_mask_idx]);
    sbox_in__[12][0][_mask_idx] = XOR(inp__[48][_mask_idx],key__[48][_mask_idx]);
    sbox_in__[13][0][_mask_idx] = XOR(inp__[52][_mask_idx],key__[52][_mask_idx]);
    sbox_in__[14][0][_mask_idx] = XOR(inp__[56][_mask_idx],key__[56][_mask_idx]);
    sbox_in__[15][0][_mask_idx] = XOR(inp__[60][_mask_idx],key__[60][_mask_idx]);
    sbox_in__[0][1][_mask_idx] = XOR(inp__[1][_mask_idx],key__[1][_mask_idx]);
    sbox_in__[1][1][_mask_idx] = XOR(inp__[5][_mask_idx],key__[5][_mask_idx]);
    sbox_in__[2][1][_mask_idx] = XOR(inp__[9][_mask_idx],key__[9][_mask_idx]);
    sbox_in__[3][1][_mask_idx] = XOR(inp__[13][_mask_idx],key__[13][_mask_idx]);
    sbox_in__[4][1][_mask_idx] = XOR(inp__[17][_mask_idx],key__[17][_mask_idx]);
    sbox_in__[5][1][_mask_idx] = XOR(inp__[21][_mask_idx],key__[21][_mask_idx]);
    sbox_in__[6][1][_mask_idx] = XOR(inp__[25][_mask_idx],key__[25][_mask_idx]);
    sbox_in__[7][1][_mask_idx] = XOR(inp__[29][_mask_idx],key__[29][_mask_idx]);
    sbox_in__[8][1][_mask_idx] = XOR(inp__[33][_mask_idx],key__[33][_mask_idx]);
    sbox_in__[9][1][_mask_idx] = XOR(inp__[37][_mask_idx],key__[37][_mask_idx]);
    sbox_in__[10][1][_mask_idx] = XOR(inp__[41][_mask_idx],key__[41][_mask_idx]);
    sbox_in__[11][1][_mask_idx] = XOR(inp__[45][_mask_idx],key__[45][_mask_idx]);
    sbox_in__[12][1][_mask_idx] = XOR(inp__[49][_mask_idx],key__[49][_mask_idx]);
    sbox_in__[13][1][_mask_idx] = XOR(inp__[53][_mask_idx],key__[53][_mask_idx]);
    sbox_in__[14][1][_mask_idx] = XOR(inp__[57][_mask_idx],key__[57][_mask_idx]);
    sbox_in__[15][1][_mask_idx] = XOR(inp__[61][_mask_idx],key__[61][_mask_idx]);
    sbox_in__[0][2][_mask_idx] = XOR(inp__[2][_mask_idx],key__[2][_mask_idx]);
    sbox_in__[1][2][_mask_idx] = XOR(inp__[6][_mask_idx],key__[6][_mask_idx]);
    sbox_in__[2][2][_mask_idx] = XOR(inp__[10][_mask_idx],key__[10][_mask_idx]);
    sbox_in__[3][2][_mask_idx] = XOR(inp__[14][_mask_idx],key__[14][_mask_idx]);
    sbox_in__[4][2][_mask_idx] = XOR(inp__[18][_mask_idx],key__[18][_mask_idx]);
    sbox_in__[5][2][_mask_idx] = XOR(inp__[22][_mask_idx],key__[22][_mask_idx]);
    sbox_in__[6][2][_mask_idx] = XOR(inp__[26][_mask_idx],key__[26][_mask_idx]);
    sbox_in__[7][2][_mask_idx] = XOR(inp__[30][_mask_idx],key__[30][_mask_idx]);
    sbox_in__[8][2][_mask_idx] = XOR(inp__[34][_mask_idx],key__[34][_mask_idx]);
    sbox_in__[9][2][_mask_idx] = XOR(inp__[38][_mask_idx],key__[38][_mask_idx]);
    sbox_in__[10][2][_mask_idx] = XOR(inp__[42][_mask_idx],key__[42][_mask_idx]);
    sbox_in__[11][2][_mask_idx] = XOR(inp__[46][_mask_idx],key__[46][_mask_idx]);
    sbox_in__[12][2][_mask_idx] = XOR(inp__[50][_mask_idx],key__[50][_mask_idx]);
    sbox_in__[13][2][_mask_idx] = XOR(inp__[54][_mask_idx],key__[54][_mask_idx]);
    sbox_in__[14][2][_mask_idx] = XOR(inp__[58][_mask_idx],key__[58][_mask_idx]);
    sbox_in__[15][2][_mask_idx] = XOR(inp__[62][_mask_idx],key__[62][_mask_idx]);
    sbox_in__[0][3][_mask_idx] = XOR(inp__[3][_mask_idx],key__[3][_mask_idx]);
    sbox_in__[1][3][_mask_idx] = XOR(inp__[7][_mask_idx],key__[7][_mask_idx]);
    sbox_in__[2][3][_mask_idx] = XOR(inp__[11][_mask_idx],key__[11][_mask_idx]);
    sbox_in__[3][3][_mask_idx] = XOR(inp__[15][_mask_idx],key__[15][_mask_idx]);
    sbox_in__[4][3][_mask_idx] = XOR(inp__[19][_mask_idx],key__[19][_mask_idx]);
    sbox_in__[5][3][_mask_idx] = XOR(inp__[23][_mask_idx],key__[23][_mask_idx]);
    sbox_in__[6][3][_mask_idx] = XOR(inp__[27][_mask_idx],key__[27][_mask_idx]);
    sbox_in__[7][3][_mask_idx] = XOR(inp__[31][_mask_idx],key__[31][_mask_idx]);
    sbox_in__[8][3][_mask_idx] = XOR(inp__[35][_mask_idx],key__[35][_mask_idx]);
    sbox_in__[9][3][_mask_idx] = XOR(inp__[39][_mask_idx],key__[39][_mask_idx]);
    sbox_in__[10][3][_mask_idx] = XOR(inp__[43][_mask_idx],key__[43][_mask_idx]);
    sbox_in__[11][3][_mask_idx] = XOR(inp__[47][_mask_idx],key__[47][_mask_idx]);
    sbox_in__[12][3][_mask_idx] = XOR(inp__[51][_mask_idx],key__[51][_mask_idx]);
    sbox_in__[13][3][_mask_idx] = XOR(inp__[55][_mask_idx],key__[55][_mask_idx]);
    sbox_in__[14][3][_mask_idx] = XOR(inp__[59][_mask_idx],key__[59][_mask_idx]);
    sbox_in__[15][3][_mask_idx] = XOR(inp__[63][_mask_idx],key__[63][_mask_idx]);
  }
  for (int i__ = 0; i__ <= 15; i__++) {
    sbox__B1(sbox_in__[i__][0],sbox_in__[i__][1],sbox_in__[i__][2],sbox_in__[i__][3],sbox_out__[i__][0],sbox_out__[i__][1],sbox_out__[i__][2],sbox_out__[i__][3]);
  }
  for (int _mask_idx = 0; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
    out__[0][_mask_idx] = sbox_out__[0][0][_mask_idx];
    out__[1][_mask_idx] = sbox_out__[1][0][_mask_idx];
    out__[2][_mask_idx] = sbox_out__[2][0][_mask_idx];
    out__[3][_mask_idx] = sbox_out__[3][0][_mask_idx];
    out__[4][_mask_idx] = sbox_out__[4][0][_mask_idx];
    out__[5][_mask_idx] = sbox_out__[5][0][_mask_idx];
    out__[6][_mask_idx] = sbox_out__[6][0][_mask_idx];
    out__[7][_mask_idx] = sbox_out__[7][0][_mask_idx];
    out__[8][_mask_idx] = sbox_out__[8][0][_mask_idx];
    out__[9][_mask_idx] = sbox_out__[9][0][_mask_idx];
    out__[10][_mask_idx] = sbox_out__[10][0][_mask_idx];
    out__[11][_mask_idx] = sbox_out__[11][0][_mask_idx];
    out__[12][_mask_idx] = sbox_out__[12][0][_mask_idx];
    out__[13][_mask_idx] = sbox_out__[13][0][_mask_idx];
    out__[14][_mask_idx] = sbox_out__[14][0][_mask_idx];
    out__[15][_mask_idx] = sbox_out__[15][0][_mask_idx];
    out__[16][_mask_idx] = sbox_out__[0][1][_mask_idx];
    out__[17][_mask_idx] = sbox_out__[1][1][_mask_idx];
    out__[18][_mask_idx] = sbox_out__[2][1][_mask_idx];
    out__[19][_mask_idx] = sbox_out__[3][1][_mask_idx];
    out__[20][_mask_idx] = sbox_out__[4][1][_mask_idx];
    out__[21][_mask_idx] = sbox_out__[5][1][_mask_idx];
    out__[22][_mask_idx] = sbox_out__[6][1][_mask_idx];
    out__[23][_mask_idx] = sbox_out__[7][1][_mask_idx];
    out__[24][_mask_idx] = sbox_out__[8][1][_mask_idx];
    out__[25][_mask_idx] = sbox_out__[9][1][_mask_idx];
    out__[26][_mask_idx] = sbox_out__[10][1][_mask_idx];
    out__[27][_mask_idx] = sbox_out__[11][1][_mask_idx];
    out__[28][_mask_idx] = sbox_out__[12][1][_mask_idx];
    out__[29][_mask_idx] = sbox_out__[13][1][_mask_idx];
    out__[30][_mask_idx] = sbox_out__[14][1][_mask_idx];
    out__[31][_mask_idx] = sbox_out__[15][1][_mask_idx];
    out__[32][_mask_idx] = sbox_out__[0][2][_mask_idx];
    out__[33][_mask_idx] = sbox_out__[1][2][_mask_idx];
    out__[34][_mask_idx] = sbox_out__[2][2][_mask_idx];
    out__[35][_mask_idx] = sbox_out__[3][2][_mask_idx];
    out__[36][_mask_idx] = sbox_out__[4][2][_mask_idx];
    out__[37][_mask_idx] = sbox_out__[5][2][_mask_idx];
    out__[38][_mask_idx] = sbox_out__[6][2][_mask_idx];
    out__[39][_mask_idx] = sbox_out__[7][2][_mask_idx];
    out__[40][_mask_idx] = sbox_out__[8][2][_mask_idx];
    out__[41][_mask_idx] = sbox_out__[9][2][_mask_idx];
    out__[42][_mask_idx] = sbox_out__[10][2][_mask_idx];
    out__[43][_mask_idx] = sbox_out__[11][2][_mask_idx];
    out__[44][_mask_idx] = sbox_out__[12][2][_mask_idx];
    out__[45][_mask_idx] = sbox_out__[13][2][_mask_idx];
    out__[46][_mask_idx] = sbox_out__[14][2][_mask_idx];
    out__[47][_mask_idx] = sbox_out__[15][2][_mask_idx];
    out__[48][_mask_idx] = sbox_out__[0][3][_mask_idx];
    out__[49][_mask_idx] = sbox_out__[1][3][_mask_idx];
    out__[50][_mask_idx] = sbox_out__[2][3][_mask_idx];
    out__[51][_mask_idx] = sbox_out__[3][3][_mask_idx];
    out__[52][_mask_idx] = sbox_out__[4][3][_mask_idx];
    out__[53][_mask_idx] = sbox_out__[5][3][_mask_idx];
    out__[54][_mask_idx] = sbox_out__[6][3][_mask_idx];
    out__[55][_mask_idx] = sbox_out__[7][3][_mask_idx];
    out__[56][_mask_idx] = sbox_out__[8][3][_mask_idx];
    out__[57][_mask_idx] = sbox_out__[9][3][_mask_idx];
    out__[58][_mask_idx] = sbox_out__[10][3][_mask_idx];
    out__[59][_mask_idx] = sbox_out__[11][3][_mask_idx];
    out__[60][_mask_idx] = sbox_out__[12][3][_mask_idx];
    out__[61][_mask_idx] = sbox_out__[13][3][_mask_idx];
    out__[62][_mask_idx] = sbox_out__[14][3][_mask_idx];
    out__[63][_mask_idx] = sbox_out__[15][3][_mask_idx];
  }

}

/* main function */
void present__ (/*inputs*/ DATATYPE plain__[64][MASKING_ORDER],DATATYPE key__[32][64][MASKING_ORDER], /*outputs*/ DATATYPE cipher__[64][MASKING_ORDER]) {

  // Variables declaration
  DATATYPE tmp__[64][MASKING_ORDER];

  // Instructions (body)
  for (int _mask_idx = 0; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
    tmp__[0][_mask_idx] = plain__[0][_mask_idx];
    tmp__[1][_mask_idx] = plain__[1][_mask_idx];
    tmp__[2][_mask_idx] = plain__[2][_mask_idx];
    tmp__[3][_mask_idx] = plain__[3][_mask_idx];
    tmp__[4][_mask_idx] = plain__[4][_mask_idx];
    tmp__[5][_mask_idx] = plain__[5][_mask_idx];
    tmp__[6][_mask_idx] = plain__[6][_mask_idx];
    tmp__[7][_mask_idx] = plain__[7][_mask_idx];
    tmp__[8][_mask_idx] = plain__[8][_mask_idx];
    tmp__[9][_mask_idx] = plain__[9][_mask_idx];
    tmp__[10][_mask_idx] = plain__[10][_mask_idx];
    tmp__[11][_mask_idx] = plain__[11][_mask_idx];
    tmp__[12][_mask_idx] = plain__[12][_mask_idx];
    tmp__[13][_mask_idx] = plain__[13][_mask_idx];
    tmp__[14][_mask_idx] = plain__[14][_mask_idx];
    tmp__[15][_mask_idx] = plain__[15][_mask_idx];
    tmp__[16][_mask_idx] = plain__[16][_mask_idx];
    tmp__[17][_mask_idx] = plain__[17][_mask_idx];
    tmp__[18][_mask_idx] = plain__[18][_mask_idx];
    tmp__[19][_mask_idx] = plain__[19][_mask_idx];
    tmp__[20][_mask_idx] = plain__[20][_mask_idx];
    tmp__[21][_mask_idx] = plain__[21][_mask_idx];
    tmp__[22][_mask_idx] = plain__[22][_mask_idx];
    tmp__[23][_mask_idx] = plain__[23][_mask_idx];
    tmp__[24][_mask_idx] = plain__[24][_mask_idx];
    tmp__[25][_mask_idx] = plain__[25][_mask_idx];
    tmp__[26][_mask_idx] = plain__[26][_mask_idx];
    tmp__[27][_mask_idx] = plain__[27][_mask_idx];
    tmp__[28][_mask_idx] = plain__[28][_mask_idx];
    tmp__[29][_mask_idx] = plain__[29][_mask_idx];
    tmp__[30][_mask_idx] = plain__[30][_mask_idx];
    tmp__[31][_mask_idx] = plain__[31][_mask_idx];
    tmp__[32][_mask_idx] = plain__[32][_mask_idx];
    tmp__[33][_mask_idx] = plain__[33][_mask_idx];
    tmp__[34][_mask_idx] = plain__[34][_mask_idx];
    tmp__[35][_mask_idx] = plain__[35][_mask_idx];
    tmp__[36][_mask_idx] = plain__[36][_mask_idx];
    tmp__[37][_mask_idx] = plain__[37][_mask_idx];
    tmp__[38][_mask_idx] = plain__[38][_mask_idx];
    tmp__[39][_mask_idx] = plain__[39][_mask_idx];
    tmp__[40][_mask_idx] = plain__[40][_mask_idx];
    tmp__[41][_mask_idx] = plain__[41][_mask_idx];
    tmp__[42][_mask_idx] = plain__[42][_mask_idx];
    tmp__[43][_mask_idx] = plain__[43][_mask_idx];
    tmp__[44][_mask_idx] = plain__[44][_mask_idx];
    tmp__[45][_mask_idx] = plain__[45][_mask_idx];
    tmp__[46][_mask_idx] = plain__[46][_mask_idx];
    tmp__[47][_mask_idx] = plain__[47][_mask_idx];
    tmp__[48][_mask_idx] = plain__[48][_mask_idx];
    tmp__[49][_mask_idx] = plain__[49][_mask_idx];
    tmp__[50][_mask_idx] = plain__[50][_mask_idx];
    tmp__[51][_mask_idx] = plain__[51][_mask_idx];
    tmp__[52][_mask_idx] = plain__[52][_mask_idx];
    tmp__[53][_mask_idx] = plain__[53][_mask_idx];
    tmp__[54][_mask_idx] = plain__[54][_mask_idx];
    tmp__[55][_mask_idx] = plain__[55][_mask_idx];
    tmp__[56][_mask_idx] = plain__[56][_mask_idx];
    tmp__[57][_mask_idx] = plain__[57][_mask_idx];
    tmp__[58][_mask_idx] = plain__[58][_mask_idx];
    tmp__[59][_mask_idx] = plain__[59][_mask_idx];
    tmp__[60][_mask_idx] = plain__[60][_mask_idx];
    tmp__[61][_mask_idx] = plain__[61][_mask_idx];
    tmp__[62][_mask_idx] = plain__[62][_mask_idx];
    tmp__[63][_mask_idx] = plain__[63][_mask_idx];
  }
  for (int i__ = 1; i__ <= 31; i__++) {
    present_round__B1(tmp__,key__[(i__ - 1)],tmp__);
  }
  for (int _mask_idx = 0; _mask_idx <= (MASKING_ORDER - 1); _mask_idx++) {
    cipher__[0][_mask_idx] = XOR(tmp__[0][_mask_idx],key__[31][0][_mask_idx]);
    cipher__[1][_mask_idx] = XOR(tmp__[1][_mask_idx],key__[31][1][_mask_idx]);
    cipher__[2][_mask_idx] = XOR(tmp__[2][_mask_idx],key__[31][2][_mask_idx]);
    cipher__[3][_mask_idx] = XOR(tmp__[3][_mask_idx],key__[31][3][_mask_idx]);
    cipher__[4][_mask_idx] = XOR(tmp__[4][_mask_idx],key__[31][4][_mask_idx]);
    cipher__[5][_mask_idx] = XOR(tmp__[5][_mask_idx],key__[31][5][_mask_idx]);
    cipher__[6][_mask_idx] = XOR(tmp__[6][_mask_idx],key__[31][6][_mask_idx]);
    cipher__[7][_mask_idx] = XOR(tmp__[7][_mask_idx],key__[31][7][_mask_idx]);
    cipher__[8][_mask_idx] = XOR(tmp__[8][_mask_idx],key__[31][8][_mask_idx]);
    cipher__[9][_mask_idx] = XOR(tmp__[9][_mask_idx],key__[31][9][_mask_idx]);
    cipher__[10][_mask_idx] = XOR(tmp__[10][_mask_idx],key__[31][10][_mask_idx]);
    cipher__[11][_mask_idx] = XOR(tmp__[11][_mask_idx],key__[31][11][_mask_idx]);
    cipher__[12][_mask_idx] = XOR(tmp__[12][_mask_idx],key__[31][12][_mask_idx]);
    cipher__[13][_mask_idx] = XOR(tmp__[13][_mask_idx],key__[31][13][_mask_idx]);
    cipher__[14][_mask_idx] = XOR(tmp__[14][_mask_idx],key__[31][14][_mask_idx]);
    cipher__[15][_mask_idx] = XOR(tmp__[15][_mask_idx],key__[31][15][_mask_idx]);
    cipher__[16][_mask_idx] = XOR(tmp__[16][_mask_idx],key__[31][16][_mask_idx]);
    cipher__[17][_mask_idx] = XOR(tmp__[17][_mask_idx],key__[31][17][_mask_idx]);
    cipher__[18][_mask_idx] = XOR(tmp__[18][_mask_idx],key__[31][18][_mask_idx]);
    cipher__[19][_mask_idx] = XOR(tmp__[19][_mask_idx],key__[31][19][_mask_idx]);
    cipher__[20][_mask_idx] = XOR(tmp__[20][_mask_idx],key__[31][20][_mask_idx]);
    cipher__[21][_mask_idx] = XOR(tmp__[21][_mask_idx],key__[31][21][_mask_idx]);
    cipher__[22][_mask_idx] = XOR(tmp__[22][_mask_idx],key__[31][22][_mask_idx]);
    cipher__[23][_mask_idx] = XOR(tmp__[23][_mask_idx],key__[31][23][_mask_idx]);
    cipher__[24][_mask_idx] = XOR(tmp__[24][_mask_idx],key__[31][24][_mask_idx]);
    cipher__[25][_mask_idx] = XOR(tmp__[25][_mask_idx],key__[31][25][_mask_idx]);
    cipher__[26][_mask_idx] = XOR(tmp__[26][_mask_idx],key__[31][26][_mask_idx]);
    cipher__[27][_mask_idx] = XOR(tmp__[27][_mask_idx],key__[31][27][_mask_idx]);
    cipher__[28][_mask_idx] = XOR(tmp__[28][_mask_idx],key__[31][28][_mask_idx]);
    cipher__[29][_mask_idx] = XOR(tmp__[29][_mask_idx],key__[31][29][_mask_idx]);
    cipher__[30][_mask_idx] = XOR(tmp__[30][_mask_idx],key__[31][30][_mask_idx]);
    cipher__[31][_mask_idx] = XOR(tmp__[31][_mask_idx],key__[31][31][_mask_idx]);
    cipher__[32][_mask_idx] = XOR(tmp__[32][_mask_idx],key__[31][32][_mask_idx]);
    cipher__[33][_mask_idx] = XOR(tmp__[33][_mask_idx],key__[31][33][_mask_idx]);
    cipher__[34][_mask_idx] = XOR(tmp__[34][_mask_idx],key__[31][34][_mask_idx]);
    cipher__[35][_mask_idx] = XOR(tmp__[35][_mask_idx],key__[31][35][_mask_idx]);
    cipher__[36][_mask_idx] = XOR(tmp__[36][_mask_idx],key__[31][36][_mask_idx]);
    cipher__[37][_mask_idx] = XOR(tmp__[37][_mask_idx],key__[31][37][_mask_idx]);
    cipher__[38][_mask_idx] = XOR(tmp__[38][_mask_idx],key__[31][38][_mask_idx]);
    cipher__[39][_mask_idx] = XOR(tmp__[39][_mask_idx],key__[31][39][_mask_idx]);
    cipher__[40][_mask_idx] = XOR(tmp__[40][_mask_idx],key__[31][40][_mask_idx]);
    cipher__[41][_mask_idx] = XOR(tmp__[41][_mask_idx],key__[31][41][_mask_idx]);
    cipher__[42][_mask_idx] = XOR(tmp__[42][_mask_idx],key__[31][42][_mask_idx]);
    cipher__[43][_mask_idx] = XOR(tmp__[43][_mask_idx],key__[31][43][_mask_idx]);
    cipher__[44][_mask_idx] = XOR(tmp__[44][_mask_idx],key__[31][44][_mask_idx]);
    cipher__[45][_mask_idx] = XOR(tmp__[45][_mask_idx],key__[31][45][_mask_idx]);
    cipher__[46][_mask_idx] = XOR(tmp__[46][_mask_idx],key__[31][46][_mask_idx]);
    cipher__[47][_mask_idx] = XOR(tmp__[47][_mask_idx],key__[31][47][_mask_idx]);
    cipher__[48][_mask_idx] = XOR(tmp__[48][_mask_idx],key__[31][48][_mask_idx]);
    cipher__[49][_mask_idx] = XOR(tmp__[49][_mask_idx],key__[31][49][_mask_idx]);
    cipher__[50][_mask_idx] = XOR(tmp__[50][_mask_idx],key__[31][50][_mask_idx]);
    cipher__[51][_mask_idx] = XOR(tmp__[51][_mask_idx],key__[31][51][_mask_idx]);
    cipher__[52][_mask_idx] = XOR(tmp__[52][_mask_idx],key__[31][52][_mask_idx]);
    cipher__[53][_mask_idx] = XOR(tmp__[53][_mask_idx],key__[31][53][_mask_idx]);
    cipher__[54][_mask_idx] = XOR(tmp__[54][_mask_idx],key__[31][54][_mask_idx]);
    cipher__[55][_mask_idx] = XOR(tmp__[55][_mask_idx],key__[31][55][_mask_idx]);
    cipher__[56][_mask_idx] = XOR(tmp__[56][_mask_idx],key__[31][56][_mask_idx]);
    cipher__[57][_mask_idx] = XOR(tmp__[57][_mask_idx],key__[31][57][_mask_idx]);
    cipher__[58][_mask_idx] = XOR(tmp__[58][_mask_idx],key__[31][58][_mask_idx]);
    cipher__[59][_mask_idx] = XOR(tmp__[59][_mask_idx],key__[31][59][_mask_idx]);
    cipher__[60][_mask_idx] = XOR(tmp__[60][_mask_idx],key__[31][60][_mask_idx]);
    cipher__[61][_mask_idx] = XOR(tmp__[61][_mask_idx],key__[31][61][_mask_idx]);
    cipher__[62][_mask_idx] = XOR(tmp__[62][_mask_idx],key__[31][62][_mask_idx]);
    cipher__[63][_mask_idx] = XOR(tmp__[63][_mask_idx],key__[31][63][_mask_idx]);
  }

}

/* Additional functions */
uint32_t bench_speed() {
  /* inputs */
  DATATYPE plain__[64][MASKING_ORDER] = { 0 };
  DATATYPE key__[32][64][MASKING_ORDER] = { 0 };

  /* Preventing inputs from being optimized out */
  asm volatile("" : "+m" (plain__));
  asm volatile("" : "+m" (key__));

  /* outputs */
  DATATYPE cipher__[64][MASKING_ORDER] = { 0 };
  /* Primitive call */
  present__(plain__, key__,cipher__);

  /* Preventing outputs from being optimized out */
  asm volatile("" : "+m" (cipher__));

  /* Returning the number of encrypted bytes */
  return 64;
}

/* **************************************************************** */
/*                            Usuba source                          */
/*                                                                  */
/*

 _no_inline table sbox(a :  v4)
  returns out :  v4
{
  12, 5, 6, 11, 9, 0, 10, 13, 3, 14, 15, 8, 4, 7, 1, 2
}


_no_inline perm pLayer(a :  b64)
  returns out :  b64
{
  1, 5, 9, 13, 17, 21, 25, 29, 33, 37, 41, 45, 49, 53, 57, 61, 2, 6, 10, 14, 18, 22, 26, 30, 34, 38, 42, 46, 50, 54, 58, 62, 3, 7, 11, 15, 19, 23, 27, 31, 35, 39, 43, 47, 51, 55, 59, 63, 4, 8, 12, 16, 20, 24, 28, 32, 36, 40, 44, 48, 52, 56, 60, 64
}


_no_inline node present_round(inp :  b64,key :  b64)
  returns out :  b64
vars
  sbox_in :  b4[16],
  sbox_out :  b4[16]
let
  (sbox_in) = (inp ^ key);
  forall i in [0,15] {
    (sbox_out[i]) = sbox(sbox_in[i])
  };
  (out) = pLayer(sbox_out)
tel

 node present(plain :  b64,key :  b64[32])
  returns cipher :  b64
vars
  tmp :  b64[32]
let
  (tmp[0]) = plain;
  forall i in [1,31] {
    (tmp[i]) = present_round(tmp[(i - 1)],key[(i - 1)])
  };
  (cipher) = (tmp[31] ^ key[31])
tel

*/
 